/* witness 

 2013-07-22 */
function update(a){var b=$("#domains");$.ajax({url:"/update",type:"GET",dataType:"text",contentType:"application/text",cache:!1,beforeSend:function(){b.addClass("loading"),notify("Checking sites....","alert alert-info")},complete:function(){b.removeClass("loading")},success:function(c){hide($("#messages")),b.html(c),logs[logs.length+1]={message:"Successfully ran @ "+(new Date).toLocaleTimeString(),status:"info"},displayLogs(),a&&a()},error:function(a,b,c){notify("There was a problem checking the sites. Reload the page to try again.","alert alert-error"),logs[logs.length+1]={message:"Failed run @ "+(new Date).toLocaleTimeString(),status:"error"},displayLogs(),console.log("process error",c)}})}function checkRows(){var a=0;$("#domain-table tr").each(function(){$(this).attr("class").indexOf("error")>-1&&a++}),Tinycon.setBubble(a)}function displayLogs(){var a=$("#logs"),b='<p class="alert alert-<status>"><msg></p>';a.html("");for(var c in logs){var d=b.replace("<msg>",logs[c].message);d=d.replace("<status>",logs[c].status),$("#logs").append(d)}}function resetMessagesUI(){m.width()>=w?m.width(m.width()-70):m.width(w)}function hide(a){a.hide()}function notify(a,b){var c=$("#messages");c.removeClass(),c.addClass(b),c.html(a),c.show()}var t,m=$("#messages"),w=$(".container16").width();$(function(){Tinycon.setOptions({width:7,height:9,font:"10px arial",colour:"#ffffff",background:"#e74c3c",fallback:!0});var a=12e4;update(function(){t=window.setInterval(function(){update(checkRows)},a),checkRows()}),resetMessagesUI(),window.onresize=function(){w=$(".container16").width(),resetMessagesUI()}});var logs=[];